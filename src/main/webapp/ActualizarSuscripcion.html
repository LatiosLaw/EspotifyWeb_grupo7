
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="estilos.css">
        <title>Espotify Web</title>
    </head>
    <body>
        
        <a href="index.jsp">Página Principal</a>
        
         <h1>Actualizar Suscripcion</h1>
        
         <form id = "actualiSus">
            <table>
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Ultima Fecha de Acrualizacion</th>
                    <th>Tipo</th>
                    <th>Estado</th>
                </tr>
            </thead>
            <tbody id="susiLista"></tbody>
            </table>
         </form>
         
         <script>
              function cargarDatosSus() {
                fetch('http://localhost:8080/EspotifyWeb/ActualizarSusServlet', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Error al cargar usuarios');
                            }
                            return response.json();
                        })
                        .then(data => {
                            const susLista = document.getElementById('susiLista');
                            susLista.innerHTML = ''; // Limpiar la lista existente

                            if (data.sus && data.sus.length > 0) {
                                data.sus.forEach(sus2 => {
                                    const susRow = document.createElement('tr');
                                    susRow.innerHTML = `
                                <td>${sus2.id}</td>
                                <td>${sus2.fecha}</td>
                                <td>${sus2.tipo}</td>
                                <td>${sus2.estado}</td>
                                <td><button onclick="acrualizar('${sus2.id}')">Actualizar Estado</button></td>
                            `;
                                    susLista.appendChild(susRow);
                                });
                            } else {
                                susLista.innerHTML = '<tr><td colspan="3">No sigues a ningún usuario.</td></tr>';
                            }
                })
                        .catch(error => {
                            console.error('Error:', error);
                           // document.getElementById('usuariosList').innerHTML = '<tr><td colspan="3">Error al cargar usuarios.</td></tr>';
                        });
            }
              window.onload = cargarDatosSus;
         </script>
    </body>
</html>
